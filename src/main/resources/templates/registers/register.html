<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<meta charset="UTF-8">
<title>Register</title>

<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	rel="stylesheet">

<script src="https://code.jquery.com/jquery-3.4.1.min.js"
	integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
	crossorigin="anonymous"></script>

<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js"
	type="text/javascript"></script>
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css"
	rel="stylesheet" type="text/css" />

<script type="text/javascript">
	$(document).ready(function() {
		$('.sidenav').sidenav();
	});
</script>

<style type="text/css">
form input[type=submit] {
	color: white;
}
</style>
</head>
<body>

	<nav
		style="padding: 0px 10px; position: absolute; background-color: #5F9EA0;">
		<div class="nav-wrapper">
			<a href="/" class="brand-logo">LOGO</a> <a href="#"
				class="sidenav-trigger" data-target="mobile-nav"> <i
				class="material-icons">menu</i>
			</a>

			<ul class="right hide-on-med-and-down ">
				<li><a th:href="@{/}"> <i title="Home"
						class="medium material-icons">home</i></a></li>
				<li><a th:href="@{/logout}"> <i title="Logout"
						class="medium material-icons">exit_to_app</i>
				</a></li>
			</ul>
		</div>
	</nav>
	<ul class="sidenav" id="mobile-nav">
		<li><a th:href="@{/}"> <i title="Home"
				class="medium material-icons">home</i>Home
		</a></li>
		<li><a th:href="@{/logout}"> <i title="Logout"
				class="medium material-icons">exit_to_app</i>Logout
		</a></li>
	</ul>

	<br />
	<br />
	<br />
	<br />
	<br />
	<div class="valign-wrapper row login-box"
		sec:authorize="hasRole('ROLE_ADMIN')">
		<div class="col card hoverable s10 pull-s1 m6 pull-m3 l10 pull-l1">
			<div class="row">

				<div class="card-content">
					<span class="card-title center-align">Cadastro de Dados</span>
					<form action="save" id="formperson" method="post"
						th:object="${personobj}" class="col s12"
						enctype="multipart/form-data">

						<br />
						<div th:each="m : ${msg}">
							<span th:text="${m}" style="color: red"></span> <br />
						</div>
						<br />
						<div class="row">
							<div class="input-field col s1">
								<label for="id" class="active">ID:</label> <input name="id"
									th:field="*{id}" readonly="readonly" id="id" class="validate">
							</div>

							<div class="input-field col s5">
								<label for="name" class="active">Nome:</label> <input
									placeholder="Informe o nome" name="name" th:field="*{name}"
									id="name" class="validate">
							</div>
							<div class="input-field col s5">
								<label for="surname" class="active">Sobrenome:</label> <input
									placeholder="Informe o sobrenome" name="surname"
									th:field="*{surname}" id="surname" class="validate">
							</div>

							<div class="input-field col s1">
								<label for="age" class="active">Idade:</label> <input
									placeholder="Informe a idade" name="age" th:field="*{age}"
									id="age" class="validate">
							</div>

							<div class="input-field col s3">
								<label for="dateBirth" class="active">Data de
									Nascimento:</label> <input name="dateBirth" th:field="*{dateBirth}"
									id="dateBirth" class="validate"
									placeholder="Informe a data de nascimento">
							</div>

							<div class="input-field col s3">
								<label for="profession" class="active">Profissão:</label> <select
									class="browser-default" th:field="*{profession}"
									id="profession">

									<option th:each="p : ${professions}" th:value="${p.id}"
										th:text="${p.name}">
								</select>

							</div>

							<div class="input-field col s3">
								<label for="office" class="active">Cargo:</label> <select
									class="browser-default" th:field="*{office}">

									<option
										th:each="c : ${T(com.giordanbetat.projectspringboot.model.Office).values()}"
										th:value="${c}" th:text="${c.office}">
								</select>

							</div>

							<div class="input-field col s3">
								<label for="genre" class="active">Sexo:</label> <select
									class="browser-default" th:field="*{genre}">

									<option value="" disabled selected>Selecione uma das
										opções</option>

									<option value="MASCULINO" th:text="Masculino" />

									<option value="FEMININO" th:text="Feminino" />

								</select>

							</div>

						</div>

						<div class="row">


							<div class="input-field col s6">
								<label for="cep" class="active">Cep:</label> <input
									placeholder="Informe um CEP válido" name="cep"
									th:field="*{cep}" id="cep" class="validate">
							</div>

							<div class="input-field col s6">
								<label for="rua" class="active">Rua:</label> <input name="rua"
									th:field="*{rua}" id="rua" class="validate">
							</div>

							<div class="input-field col s6">
								<label for="bairro" class="active">Bairro:</label> <input
									name="bairro" th:field="*{bairro}" id="bairro" class="validate">
							</div>

							<div class="input-field col s6">
								<label for="cidade" class="active">Cidade:</label> <input
									name="cidade" th:field="*{cidade}" id="cidade" class="validate">
							</div>

							<div class="input-field col s6">
								<label for="uf" class="active">UF:</label> <input name="uf"
									th:field="*{uf}" id="uf" class="validate">
							</div>

							<div class="input-field col s6">
								<label for="ibge" class="active">IBGE:</label> <input
									name="ibge" th:field="*{ibge}" id="ibge" class="validate">
							</div>
						</div>

						<div class="row">
							<div class="file-field input-field col s3">
								<div class="btn">
									<span>Curriculo</span> <input type="file" name="file" id="file">
								</div>
								<div class="file-path-wrapper">
									<input class="file-path validate" type="text">
								</div>
							</div>
						</div>

						<div class="row">
							<div class="center-align">
								<input class="btn waves-effect waves-light" type="submit"
									value="save">

								<button class="btn waves-effect waves-light"
									onclick="document.getElementById('formperson').reset();">NOVO</button>
							</div>
						</div>

					</form>
				</div>
			</div>
		</div>
	</div>

	<br />

	<div class="valign-wrapper row login-box">
		<div class="col card hoverable s10 pull-s1 m6 pull-m3 l10 pull-l1">
			<div class="row">
				<div class="card-content">
					<span class="card-title center-align">Buscar Usuários</span>
					<nav style="background-color: #5F9EA0">
						<div class="nav-wrapper">
							<form action="searchperson" method="post"
								th:object="${personobj}">
								<div class="input-field">
									<input placeholder="Pesquisa por nome" id="search"
										type="search" name="name" required> <label
										class="label-icon" for="name"> <i
										class="material-icons">search</i>
									</label> <i class="material-icons">close</i>
								</div>
							</form>
						</div>
					</nav>
					<br /> <br />
					<nav style="background-color: #5F9EA0">
						<div class="nav-wrapper">
							<form action="searchperson" method="post"
								th:object="${personobj}">
								<div class="input-field">
									<input placeholder="Pesquisa por genero" id="search"
										type="search" name="genre" required> <label
										class="label-icon" for="genre"> <i
										class="material-icons">search</i>
									</label> <i class="material-icons">close</i>
								</div>
							</form>
						</div>
					</nav>
					<br /> <br />
					<div class="row">
						<form action="printreport" th:object="${personobj}">
							<div class="input-field col s6">
								<label for="name" class="active">Imprimir Relatorio por
									nome:</label> <input name="name" id="name" class="validate"
									th:value="${name}" />
							</div>
							<div class="input-field col s12">
								<input class="waves-effect waves-light btn" type="submit"
									value="PDF">

							</div>
						</form>
					</div>

					<br /> <br /> <br />
					<table class="highlight centered responsive-table">

						<thead>
							<tr>
								<th>ID:</th>
								<th>NOME:</th>
								<th>SOBRENOME:</th>
								<th>CURRICULO:</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="person : ${persons}">

								<td th:text="${person.id}" />

								<td><a
									th:href="@{/phones/{idperson}(idperson=${person.id})}"> <span
										th:text="${person.name}"></span>
								</a></td>

								<td th:text="${person.surname}" />

								<td sec:authorize="hasRole('ROLE_ADMIN')">
									
								<a th:if="${person.curriculum != null}"	class="btn green waves-effect waves-light"
									th:href="@{/downloadCurriculum/{idperson}(idperson=${person.id})}"><i
										class="medium material-icons">picture_as_pdf</i></a> 
										
								<a th:if="${person.curriculum == null}" class="btn black waves-effect waves-light"><i
										class="medium material-icons">picture_as_pdf</i></a>
										
								</td>

								<td sec:authorize="hasRole('ROLE_ADMIN')"><a
									class="btn blue waves-effect waves-light"
									th:href="@{/editperson/{idperson}(idperson=${person.id})}"><i
										class="medium material-icons">edit</i></a></td>
								<td sec:authorize="hasRole('ROLE_ADMIN')"><a
									class="btn red waves-effect waves-light"
									th:href="@{/removeperson/{idperson}(idperson=${person.id})}"><i
										class="medium material-icons">delete_forever</i></a></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<script>
		$(function() {
			$(".button-collapse").sideNav();
		});
	</script>

	<script type="text/javascript">
		$(document)
				.ready(
						function() {

							$('#dateBirth').datepicker({
								showOthermonths : true,
								format : 'yyyy-mm-dd'
							});

							function limpa_formulário_cep() {
								// Limpa valores do formulário de cep.
								$("#rua").val("");
								$("#bairro").val("");
								$("#cidade").val("");
								$("#uf").val("");
								$("#ibge").val("");
							}

							//Quando o campo cep perde o foco.
							$("#cep")
									.blur(
											function() {

												//Nova variável "cep" somente com dígitos.
												var cep = $(this).val()
														.replace(/\D/g, '');

												//Verifica se campo cep possui valor informado.
												if (cep != "") {

													//Expressão regular para validar o CEP.
													var validacep = /^[0-9]{8}$/;

													//Valida o formato do CEP.
													if (validacep.test(cep)) {

														//Preenche os campos com "..." enquanto consulta webservice.
														$("#rua").val("...");
														$("#bairro").val("...");
														$("#cidade").val("...");
														$("#uf").val("...");
														$("#ibge").val("...");

														//Consulta o webservice viacep.com.br/
														$
																.getJSON(
																		"https://viacep.com.br/ws/"
																				+ cep
																				+ "/json/?callback=?",
																		function(
																				dados) {

																			if (!("erro" in dados)) {
																				//Atualiza os campos com os valores da consulta.
																				$(
																						"#rua")
																						.val(
																								dados.logradouro);
																				$(
																						"#bairro")
																						.val(
																								dados.bairro);
																				$(
																						"#cidade")
																						.val(
																								dados.localidade);
																				$(
																						"#uf")
																						.val(
																								dados.uf);
																				$(
																						"#ibge")
																						.val(
																								dados.ibge);
																			} //end if.
																			else {
																				//CEP pesquisado não foi encontrado.
																				limpa_formulário_cep();
																				alert("CEP não encontrado.");
																			}
																		});
													} //end if.
													else {
														//cep é inválido.
														limpa_formulário_cep();
														alert("Formato de CEP inválido.");
													}
												} //end if.
												else {
													//cep sem valor, limpa formulário.
													limpa_formulário_cep();
												}
											});
						});
	</script>
</body>
</html>